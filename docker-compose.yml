version: '2.1'
services:
    mysql:
        container_name: mysql-db
        image: mysql
        expose:
            - 3306
        ports:
            - 3306:3306
        environment:
            - MYSQL_DATABASE=elastest-etm
            - MYSQL_ROOT_PASSWORD=admin 
        networks:
            - build-image-network
    
    elastest-torm:
        depends_on:
            - mysql
        container_name: elastest-torm
        build: ./docker/elastest-torm            
        image: elastest/elastest-torm
        entrypoint: /testing-mysqlstate-entrypoint.sh
        environment:
            - MYSQL_DATABASE=elastest-etm
            - MYSQL_ROOT_PASSWORD=admin
        expose:
            - 8091
        ports:
            - 8091:8091
        networks:
            - build-image-network
        links:
            - mysql:mysql-db        
networks:
    build-image-network:
        driver: bridge
